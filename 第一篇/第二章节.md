第二章节 框架设计的核心要素

2.1 提升用户开发体验

        在设计框架时，合理的警告信息，可以让用户快速定位到问题的所在，进而进行修改，这可以给用
    户带来更好的开发体验。比如：

        1. createApp(App).mount('#not-exist')

        当创建一个Vue.js应用并试图挂载在不存在的DOM节点时，会收到一条警告，该信息会告诉我们挂
    载失败了，并且说明了Vue.js根据我们提供的选择器无法找到相应的DOM元素。这条信息可以让我们很
    快就定位到了问题所在。所以框架设计过程中，友好的警告信息至关重要。

        在Vue.js源码中，可以看到经常调用warn函数.如提醒找不到挂载的目标DOM元素警告:

        1. warn(`Failed to mount app: mount target selector "${container}" returned null`)

        对于warn函数来说，由于需要尽可能提供有用信息，因此需要收集当前发生错误的组件栈信息，源
    码中会有些复杂，但是最终就是调用了console.warn函数。

        在Vue3中除了必要的警告信息外，还有许多提升用户开发体验的点。例如，在控制台打印一个ref
    数据：

        1. const count = ref(0)
        2. console.log(count)

        在控制台中会输出一个RefImpl的对象，打印的数据非常不直观。在Vue3的源码中，可以搜索
    initCustomFormatter的函数，该函数可以在开发环境下初始化自定义formatter。以Chrome为例，
    可以打开DevTools的设置，勾选“Console”中的“Enable custom formatter”选项，然后刷新浏览器
    就可以看到控制台输出的内容变得非常直观。

2.2 控制框架代码的体积

        框架的大小也是衡量框架的标准之一。实现同样功能情况下，代码越少越好，这样体积就会越小，
    浏览器加载资源的时间也会越少。

        在Vue.js中提供越完善的警告提示就意味着代码量的增加，Vue3源码中，每个warn函数的调用都
    会配合__DEV__常量的检查。例如：

        1. if (__DEV__ && !res) {
            warn(`Failed to mount app: mount target selector "${container}" returned null`)
        }

        打印警告的信息前提就是__DEV__常量必须为true才行。

        Vue.js使用rollup.js对项目进行构建,这里的__DEV__是通过rollup.js的插件配置来预定义的
    其功能类似于webpack的DefinePlugin插件。

        Vue.js输出资源时会有两个版本，其中一个用于开发环境，如vue.globel.js,另一个版本用于生
    产环境,如vue.globel.prod.js。

        当Vue.js构建用于开发环境资源时,会把__DEV__常量预设为true,这时警告信息在开发环境肯定
    存在的。在生产环境时__DEV__常量预设为false,这样警告信息就不会执行,不会出现在最终产物中,
    在构建资源时会被移除。

        这样就可以做到在开发环境中提供友好的警告信息的同时,不会在增加生产环境代码的体积。

   