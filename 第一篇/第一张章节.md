第一章节：权衡的艺术

1.1 命令式和声明式

    从范式上看来，试视图层框架通常分为“声明式”与“命令式”，他们各有优缺点，框架设计者通常会想办法取其两者的优点结合设计框架。
    早年流行的jQuery就是典型的命令式框架。命令式框架的一大特点就是“关注过程”。如：

        1. -获取id为app的div标签
        2. -它的文本内容为hello world
        3. -为其绑定点击事件
        4. -当点击时弹出提示：ok
    
    对应jQuery代码：

        1. $('app').text('hello world').on('click', () =>{alert('ok')})
   
    对应原生代码：

        1. const div = document.querySelector('#app')
        2. div.innerText = 'hello world'
        3. div.addEventListener('click', () =>{alert('ok')}) //绑定一个事件
    
    可以看到，自然语言描述能够与代码产生一一对应的关系，代码本身描述的就是“做事的过程”。

    声明式与命令式不同，声明式框架更加关注结果。结合Vue.js，可以看看如何实现上面例子描述的功能：

        1. <div @click="() => alert('ok')"> hello world </div>

    这段HTML的模板就是使用Vue.js实现的上述例子。可以看到我们提供的是一个“结果”，至于怎么实现的我们并不关心，我们告诉Vue.js我们需要什么，然后Vue.js给我们返回“结果”，至于实现过程，则是Vue.js帮我们完成的。
    Vue.js帮我们封装了过程。因此，我们可以猜到Vue.js的内部实现一定是命令式的，而暴露给用户的却是声明式。

1.2 性能与可维护性的权衡

    声明式代码的性能不优于命令式代码的性能，命令式和声明式各有优缺点，在框架设计方面，则体现在性能与可维护性之间的权衡。

    拿上面的例子来说，将div标签的文本内容修改为hello vue3，使用命令式代码实现：

        1. div.textContent = 'hello vue3' //直接修改
    
    这个是性能最好的实现方式了，理论上命令式代码可以做到性能的极致，因为我们明确知道改变哪里，只做必要修改就可以，但是声明式不一定做到这点：

        1. <div @click="() => alert('ok')"> hello vue3 </div>
    
    框架需为了最优更新性能，需要找到差异并只更新变化的地方，实际最终还是使用上面命令式代码修改。

    如果将直接修改性能消耗定义为A，查找差异性能消耗为B，那么可以得出：

        1. 命令式代码更新性能消耗 = A
        2. 声明式代码更新性能消耗 = A + B
    
    可以看出声明式代码会比命令式代码多出找出差异的性能消耗，因此最理想的情况是，当找出差异性能消耗为时，命令式和声明式的性能为相同的，但是无法做到超越，毕竟框架本身就是封装命令式代码才实现了面向用户的声明式。从这得出了前文的结论：声明式代码不优于命令式代码。

    命令式虽然拥有更优的性能，但是维护性不如声明式，声明式只需要关注结果就好，其他的操作由框架内部完成。但是命令式需要关注过程，需要维护整个过程，包括DOM的创建、更新、删除等。

    因此我们需要在框架上进行维护性与性能之间的权衡。采用声明式提升维护性的同时会照成性能的损失，因此框架设计者要做的就是：保持可维护性的同时让性能损失最小化。